# 性能测试文档

## 测试套件概述

本性能测试套件包含多个测试类，全面评估GitHub Action调度器在不同场景下的性能表现。

## 测试类说明

### 1. PerformanceTestSuite
**综合性能测试套件**

包含以下测试：
- **吞吐量测试**: 测试系统在固定时间内能处理的请求数量
- **响应时间测试**: 测试P50/P95/P99响应时间分布
- **高并发压力测试**: 测试1000并发请求的处理能力
- **虚拟线程性能测试**: 验证虚拟线程在高并发场景下的优势
- **长时间稳定性测试**: 5分钟持续负载测试
- **资源使用测试**: 监控内存和资源使用情况

### 2. LoadTest
**负载测试**

模拟不同负载场景：
- **轻负载**: 10并发, 100请求
- **中等负载**: 50并发, 500请求
- **重负载**: 100并发, 1000请求

### 3. StressTest
**压力测试**

测试系统在极限场景下的表现：
- **突发流量测试**: 模拟短时间内大量请求涌入
- **逐步增加负载测试**: 测试系统在不同负载级别下的表现
- **系统恢复测试**: 测试系统在过载后的恢复能力

## 运行测试

### 运行所有性能测试
```bash
mvn test -Dtest=*Performance*
```

### 运行特定测试类
```bash
# 综合性能测试
mvn test -Dtest=PerformanceTestSuite

# 负载测试
mvn test -Dtest=LoadTest

# 压力测试
mvn test -Dtest=StressTest
```

### 运行特定测试方法
```bash
mvn test -Dtest=PerformanceTestSuite#testThroughput
```

## 性能指标说明

### 响应时间指标
- **P50**: 50%的请求响应时间小于此值
- **P95**: 95%的请求响应时间小于此值
- **P99**: 99%的请求响应时间小于此值

### 吞吐量
- 单位：请求/秒 (req/s)
- 表示系统在单位时间内能处理的请求数量

### 成功率
- 成功处理的请求占总请求的百分比
- 目标：>95%

## 性能基准

### 预期性能指标

| 测试场景 | 并发数 | 吞吐量 | P95响应时间 | 成功率 |
|---------|--------|--------|-------------|--------|
| 轻负载 | 10 | >50 req/s | <2s | >99% |
| 中等负载 | 50 | >30 req/s | <5s | >95% |
| 重负载 | 100 | >20 req/s | <10s | >90% |
| 高并发 | 1000 | >10 req/s | <30s | >80% |

### 虚拟线程优势
- 在10000请求测试中，虚拟线程应能达到 >50 req/s 的吞吐量
- 相比传统线程池，虚拟线程能处理更高的并发数

## 注意事项

1. **测试环境**: 确保测试环境有足够的资源（CPU、内存）
2. **网络延迟**: 本地测试网络延迟较低，生产环境可能有所不同
3. **预热**: 某些测试包含预热阶段，确保JVM已充分优化
4. **超时设置**: 某些测试设置了较长的超时时间，请耐心等待

## 结果分析

测试完成后会输出详细的性能报告，包括：
- 总请求数和成功/失败统计
- 响应时间分布（最小值、最大值、平均值、P50/P95/P99）
- 吞吐量指标
- 资源使用情况

## 持续改进

根据测试结果，可以：
1. 调整虚拟线程配置
2. 优化Runner服务实现
3. 调整超时和重试策略
4. 优化数据库连接池（如果使用）
